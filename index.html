<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CyberGator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet">
    <style>
        body {
            background: linear-gradient(135deg, #0f172a 0%, #1e293b 100%);
            font-family: 'Inter', sans-serif;
        }
        .news-item {
            transition: transform 0.3s ease;
        }
        .news-item:hover {
            transform: scale(1.02);
        }
        .glass-card {
            background: rgba(30, 41, 59, 0.6);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.125);
        }
    </style>
</head>
<body class="min-h-screen text-gray-100">
    <div class="container mx-auto px-4 py-8 max-w-7xl">
        <header class="text-center mb-12">
            <h1 class="text-4xl font-bold text-white mb-4">CyberGator</h1>
            <p class="text-gray-400 max-w-2xl mx-auto">
                Real-time threat intelligence generation based on latest cybersecurity news
            </p>
        </header>

        <!-- News Container -->
        <div id="news-container" class="grid md:grid-cols-3 gap-4 mb-8"></div>
        
        <!-- Generate Button -->
        <div class="text-center mb-8">
            <button id="generate-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg">
                Generate Threat Hunting Hypothesis
            </button>
            
            <div id="loading" class="hidden mt-4">
                <div class="flex items-center justify-center">
                    <div class="animate-spin rounded-full h-8 w-8 border-t-2 border-blue-500"></div>
                    <span class="ml-3 text-blue-300">Analyzing news and generating hypothesis...</span>
                </div>
            </div>
        </div>

        <!-- Hypothesis Container -->
        <div id="hypothesis-container" class="hidden">
            <div class="glass-card p-6 rounded-lg">
                <h2 class="text-2xl font-bold text-center text-blue-400 mb-6">
                    Threat Hunting Hypotheses
                </h2>
                <div id="hypothesis-list" class="space-y-4"></div>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center mt-12 text-gray-400 text-sm">
            Created by Pratik Goswami<br>
            <a href="https://www.linkedin.com/in/topratik/" target="_blank" class="text-blue-400 hover:text-blue-300 transition duration-300">
                Connect on LinkedIn
            </a>
        </div>
    </div>

    <script>
        const newsContainer = document.getElementById('news-container');
        const generateButton = document.getElementById('generate-button');
        const hypothesisContainer = document.getElementById('hypothesis-container');
        const hypothesisList = document.getElementById('hypothesis-list');
        const loadingElement = document.getElementById('loading');
        const corsProxy = 'https://api.rss2json.com/v1/api.json?rss_url=';
        const rssFeeds = [
            'https://www.bleepingcomputer.com/feed/',
            'https://feeds.feedburner.com/TheHackersNews',
            'https://threatpost.com/feed/',
            'https://www.darkreading.com/rss.xml',
            'https://krebsonsecurity.com/feed/',
            'https://www.securityweek.com/feed/',
            'https://nakedsecurity.sophos.com/feed/',
            'https://www.schneier.com/feed/atom/',
            'https://www.infosecurity-magazine.com/rss/news/',
            'https://www.cisa.gov/uscert/ncas/current-activity.xml',
            'https://www.zdnet.com/topic/security/rss.xml',
            'https://www.csoonline.com/index.rss',
            'https://www.helpnetsecurity.com/feed/',
            'https://www.scmagazine.com/feed/',
            'https://www.cyberscoop.com/feed/',
            'https://www.cybersecuritydive.com/feeds/news/',
            'https://www.databreachtoday.com/rss-feeds',
            'https://www.bankinfosecurity.com/rss-feeds',
            'https://www.govinfosecurity.com/rss-feeds',
            'https://www.healthcareinfosecurity.com/rss-feeds'
        ];
        
        let newsArticles = [];

        async function fetchRSS(url) {
            try {
                const response = await fetch(corsProxy + encodeURIComponent(url));
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                return data.items.slice(0, 5).map(item => ({
                    title: item.title,
                    link: item.link,
                    description: item.description,
                    pubDate: item.pubDate
                }));
            } catch (error) {
                console.error('Error fetching RSS feed:', error.message);
                return [];
            }
        }

        function displayNews(newsItems) {
            newsContainer.innerHTML = '';
            if (newsItems.length === 0) {
                newsContainer.innerHTML = '<p class="text-gray-400 text-center">No news articles available at this time.</p>';
                return;
            }
            newsArticles = newsItems;
            newsItems.forEach(item => {
                const newsItem = document.createElement('div');
                newsItem.className = 'news-item bg-gray-800 p-4 rounded-lg shadow-lg hover:bg-gray-700 transition duration-300';
                newsItem.innerHTML = `
                    <h3 class="text-lg font-semibold text-blue-300 mb-2">
                        <a href="${item.link}" target="_blank" class="hover:underline">${item.title}</a>
                    </h3>
                    <p class="text-gray-400 text-sm mb-2">${stripHtml(item.description).slice(0, 150)}...</p>
                    <small class="text-gray-500 text-xs">${new Date(item.pubDate).toLocaleString()}</small>
                `;
                newsContainer.appendChild(newsItem);
            });
        }

        function stripHtml(html) {
            let tmp = document.createElement("DIV");
            tmp.innerHTML = html;
            return tmp.textContent || tmp.innerText || "";
        }

        async function updateNews() {
            try {
                const allNews = await Promise.all(rssFeeds.map(fetchRSS));
                const flattenedNews = allNews.flat();
                if (flattenedNews.length === 0) {
                    throw new Error('No articles retrieved from RSS feeds.');
                }
                flattenedNews.sort((a, b) => new Date(b.pubDate) - new Date(a.pubDate));
                displayNews(flattenedNews.slice(0, 15));
            } catch (error) {
                console.error('Error updating news:', error.message);
                displayNews([]);
            }
        }

        function generateThreatHuntingHypothesis() {
            loadingElement.classList.remove('hidden');
            generateButton.disabled = true;
            
            setTimeout(() => {
                const hypotheses = generateHypothesisFromArticles(newsArticles);
                displayHypothesis(hypotheses);
                loadingElement.classList.add('hidden');
                generateButton.disabled = false;
                hypothesisContainer.classList.remove('hidden');
                
                hypothesisContainer.scrollIntoView({ behavior: 'smooth' });
            }, 2000);
        }

        function generateHypothesisFromArticles(articles) {
            if (articles.length === 0) {
                return [{
                    title: 'No Data Available',
                    hypothesis: 'Unable to generate hypothesis due to lack of news articles.',
                    context: 'Check RSS feed sources or internet connection and try again.'
                }];
            }
            return articles.slice(0, 10).map((article, index) => {
                const creativeIdeas = [
                    {
                        title: article.title,
                        hypothesis: `Hunt for shadow IT exploiting "${article.title}" by monitoring unsanctioned cloud uploads.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> Employees might bypass security uploading data related to this on ${new Date(article.pubDate).toLocaleDateString()}.</li>
                                <li><strong>TTPs:</strong> Data exfiltration (T1041), abuse of cloud services (T1213).</li>
                                <li><strong>Search:</strong> Look for spikes in cloud traffic not tied to approved apps.</li>
                                <li><strong>Out-of-Box:</strong> Set up a honeypot cloud bucket to catch leaks.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Investigate if "${article.title}" is a decoy for a larger APT campaign targeting your sector.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> Noise from this event on ${new Date(article.pubDate).toLocaleDateString()} could mask stealthier attacks.</li>
                                <li><strong>TTPs:</strong> Obfuscated files (T1027), C2 (T1071).</li>
                                <li><strong>Search:</strong> Correlate with low-and-slow traffic patterns.</li>
                                <li><strong>Out-of-Box:</strong> Deploy deceptive endpoints to lure attackers.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Probe for insider threats amplifying "${article.title}" via unauthorized device use.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> This incident on ${new Date(article.pubDate).toLocaleDateString()} might inspire rogue insiders.</li>
                                <li><strong>TTPs:</strong> Physical access (T1200), data theft (T1030).</li>
                                <li><strong>Search:</strong> Check USB logs or unsanctioned hardware connections.</li>
                                <li><strong>Out-of-Box:</strong> Plant fake sensitive files to track insider moves.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Explore if "${article.title}" ties to a supply chain attack via third-party chatter.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> Vendor mentions on ${new Date(article.pubDate).toLocaleDateString()} could hint at broader compromise.</li>
                                <li><strong>TTPs:</strong> Supply chain compromise (T1195), backdoors (T1543).</li>
                                <li><strong>Search:</strong> Audit vendor-related traffic or software updates.</li>
                                <li><strong>Out-of-Box:</strong> Scrape dark web for vendor leak mentions.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Hunt for IoT exploitation linked to "${article.title}" as a botnet precursor.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> IoT chatter on ${new Date(article.pubDate).toLocaleDateString()} might signal a buildup.</li>
                                <li><strong>TTPs:</strong> Brute force (T1110), network sniffing (T1040).</li>
                                <li><strong>Search:</strong> Monitor IoT device outbound connections.</li>
                                <li><strong>Out-of-Box:</strong> Simulate an IoT honeypot to trap bots.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Investigate if "${article.title}" masks a zero-day exploit in your tech stack.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> This event on ${new Date(article.pubDate).toLocaleDateString()} could be a smokescreen.</li>
                                <li><strong>TTPs:</strong> Exploitation (T1203), privilege escalation (T1068).</li>
                                <li><strong>Search:</strong> Look for crashes or unknown processes.</li>
                                <li><strong>Out-of-Box:</strong> Cross-check with underground forums for zero-day sales.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Probe for ransomware prep tied to "${article.title}" via unusual encryption spikes.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> Pre-attack signals on ${new Date(article.pubDate).toLocaleDateString()} might be subtle.</li>
                                <li><strong>TTPs:</strong> Data encryption (T1486), lateral movement (T1021).</li>
                                <li><strong>Search:</strong> Detect rapid file changes or shadow copies deletion.</li>
                                <li><strong>Out-of-Box:</strong> Use canary files to trigger alerts.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Hunt for phishing lures mimicking "${article.title}" in your email traffic.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> Attackers might weaponize this news from ${new Date(article.pubDate).toLocaleDateString()}.</li>
                                <li><strong>TTPs:</strong> Spearphishing (T1566.001), credential theft (T1552).</li>
                                <li><strong>Search:</strong> Filter emails for article keywords or fake domains.</li>
                                <li><strong>Out-of-Box:</strong> Send fake phishing tests to train users.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Investigate if "${article.title}" hints at a cloud breach via misconfig echoes.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> Misconfigs reported on ${new Date(article.pubDate).toLocaleDateString()} could ripple to your cloud.</li>
                                <li><strong>TTPs:</strong> Unauthorized access (T1078), cloud data exposure (T1530).</li>
                                <li><strong>Search:</strong> Audit cloud logs for public bucket access.</li>
                                <li><strong>Out-of-Box:</strong> Simulate a breach to test response time.</li>
                            </ul>
                        `
                    },
                    {
                        title: article.title,
                        hypothesis: `Explore if "${article.title}" is exploited via social media disinformation campaigns.`,
                        context: `
                            <ul class="list-disc list-inside text-gray-500">
                                <li><strong>Unconventional Insight:</strong> News on ${new Date(article.pubDate).toLocaleDateString()} might fuel panic-driven attacks.</li>
                                <li><strong>TTPs:</strong> Social engineering (T1566), malware distribution (T1204).</li>
                                <li><strong>Search:</strong> Monitor internal chats for article-related links.</li>
                                <li><strong>Out-of-Box:</strong> Analyze X posts for coordinated threat mentions.</li>
                            </ul>
                        `
                    }
                ];
                return creativeIdeas[index];
            });
        }

        function displayHypothesis(hypotheses) {
            hypothesisList.innerHTML = '';
            
            hypotheses.forEach((item, index) => {
                const hypothesisItem = document.createElement('div');
                hypothesisItem.className = 'bg-gray-800 p-4 rounded-lg';
                hypothesisItem.innerHTML = `
                    <h3 class="text-lg font-bold text-blue-400 mb-2">${index + 1}. ${item.title}</h3>
                    <p class="text-gray-300 mb-2"><strong>Hypothesis:</strong> ${item.hypothesis}</p>
                    <div class="text-gray-500"><strong>Threat Context:</strong> ${item.context}</div>
                `;
                hypothesisList.appendChild(hypothesisItem);
            });
        }

        // Event listeners
        generateButton.addEventListener('click', generateThreatHuntingHypothesis);

        // Initialize the page
        updateNews();
    </script>
</body>
</html>
